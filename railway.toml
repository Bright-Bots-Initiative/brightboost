[build]
command = "bun install && bun run build && cd backend && bun install && bunx prisma generate --schema=prisma/schema.prisma && bunx tsc -p . && echo '--- backend dist ---' && ls -R dist"

[deploy]
startCommand = "sh -lc 'set -e; echo \"PWD=$(pwd)\"; ls -la; echo \"--- backend dir ---\"; ls -la backend || true; echo \"--- backend/dist tree ---\"; ls -R backend/dist || true; if [ -f backend/dist/src/server.js ]; then node backend/dist/src/server.js; elif [ -f backend/dist/server.js ]; then node backend/dist/server.js; elif [ -f backend/dist/index.js ]; then node backend/dist/index.js; else echo \"FATAL: no backend dist entry found\"; exit 1; fi'"
